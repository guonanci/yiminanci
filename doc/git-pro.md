#1起步 及 历史

1.1.2 集中化的版本控制系统
接下来人们又遇到一个问题，如何让在不同系统上的开发者协同工作？于是，集中化的版
本控制系统（ Centralized Version Control Systems，简称 CVCS ）应运而生。这类系
图 1.1: 本地版本控制系统
统，诸如 CVS，Subversion 以及 Perforce 等，都有一个单一的集中管理的服务器，保存
所有文件的修订版本，而协同工作的人们都通过客户端连到这台服务器，取出最新的文件或
者提交更新。多年以来，这已成为版本控制系统的标准做法（见图 1-2）。

这种做法带来了许多好处，特别是相较于老式的本地 VCS 来说。现在，每个人都可以在
一定程度上看到项目中的其他人正在做些什么。而管理员也可以轻松掌控每个开发者的权
限，并且管理一个 CVCS 要远比在各个客户端上维护本地数据库来得轻松容易。
事分两面，有好有坏。这么做最显而易见的缺点是中央服务器的单点故障。如果宕机一小
时，那么在这一小时内，谁都无法提交更新，也就无法协同工作。要是中央服务器的磁盘发
生故障，碰巧没做备份，或者备份不够及时，就会有丢失数据的风险。最坏的情况是彻底丢
失整个项目的所有历史更改记录，而被客户端偶然提取出来的保存在本地的某些快照数据就
成了恢复数据的希望。但这样的话依然是个问题，你不能保证所有的数据都已经有人事先完
整提取出来过。本地版本控制系统也存在类似问题，只要整个项目的历史记录被保存在单一
位置，就有丢失所有历史更新记录的风险。

1.1.3 分布式版本控制系统
于是分布式版本控制系统（ Distributed Version Control System，简称 DVCS ）面世
了。在这类系统中，像 Git，Mercurial，Bazaar 以及 Darcs 等，客户端并不只提取最新版
本的文件快照，而是把代码仓库完整地镜像下来。这么一来，任何一处协同工作用的服务器
发生故障，事后都可以用任何一个镜像出来的本地仓库恢复。因为每一次的提取操作，实际
上都是一次对代码仓库的完整备份（见图 1-3）。
图 1.3: 分布式版本控制系统
更进一步，许多这类系统都可以指定和若干不同的远端代码仓库进行交互。籍此，你就可
以在同一个项目中，分别和不同工作小组的人相互协作。你可以根据需要设定不同的协作流
程，比如层次模型式的工作流，而这在以前的集中式系统中是无法实现的。



文件快照是什么意思...

##1.2 git 简史
同生活中的许多伟大事件一样，Git 诞生于一个极富纷争大举创新的年代。Linux 内核开
源项目有着为数众广的参与者。绝大多数的 Linux 内核维护工作都花在了提交补丁和保存
归档的繁琐事务上（1991－2002年间）。到 2002 年，整个项目组开始启用分布式版本控
制系统 BitKeeper 来管理和维护代码。
到了 2005 年，开发 BitKeeper 的商业公司同 Linux 内核开源社区的合作关系结束，他
们收回了免费使用 BitKeeper 的权力。这就迫使 Linux 开源社区（特别是 Linux 的缔造者
Linus Torvalds ）不得不吸取教训，只有开发一套属于自己的版本控制系统才不至于重蹈
覆辙。他们对新的系统制订了若干目标：

速度

简单的设计

对非线性开发模式的强力支持（允许上千个并行开发的分支）

完全分布式

有能力高效管理类似 Linux 内核一样的超大规模项目（速度和数据量）
自诞生于 2005 年以来，Git 日臻成熟完善，在高度易用的同时，仍然保留着初期设定的
目标。它的速度飞快，极其适合管理大项目，它还有着令人难以置信的非线性分支管理系统
（见第三章），可以应付各种复杂的项目开发需求。

##1.3 git 基础
Subversion Perforce
如果理解了 git 的思想和基本工作原理, 就会用起来游刃有余.开始学习 git 的时候, 不要尝试把各种概念


和其他版本控制系统（诸如 Subversion 和 Perforce 等）相
比拟，否则容易混淆每个操作的实际意义。Git 在保存和处理各种信息的时候，虽然操作起
来的命令形式非常相近，但它与其他版本控制系统的做法颇为不同。理解这些差异将有助于
你准确地使用 Git 提供的各种工具。
1.3.1 直接记录快照，而非差异比较
Git 和其他版本控制系统的主要差别在于，Git 只关心文件数据的整体是否发生变化，而大
多数其他系统则只关心文件内容的具体差异。这类系统（CVS，Subversion，Perforce，
Bazaar 等等）每次记录有哪些文件作了更新，以及都更新了哪些行的什么内容，请看图


git会把出现变更的文件直接拷贝，形成新的blob，而非与上一个版本的diff。所以一旦需要查看某版本直接load即可，而其他差异版本控制需要做merge，所以快。空间换时间。并非每个当前版本都需要做备份，如果没有改变，那么快照其实是链接上一个版本。git会在隐藏目录.git里存在object里，定期会优化，保证快照空间，和读取时间的平衡。

作者：知乎用户
链接：https://www.zhihu.com/question/27680108/answer/62905277
来源：知乎
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。



Git 并不保存这些前后变化的差异数据。实际上，Git 更像是把变化的文件作快照后，记
录在一个微型的文件系统中。每次提交更新时，它会纵览一遍所有文件的指纹信息并对文件
作一快照，然后保存一个指向这次快照的索引。为提高性能，若文件没有变化，Git 不会再
次保存，而只对上次保存的快照作一链接。Git 的工作方式就像图 1-5 所示。
图 1.5: Git 保存每次更新时的文件快照
这是 Git 同其他系统的重要区别。它完全颠覆了传统版本控制的套路，并对各个环节的实
现方式作了新的设计。Git 更像是个小型的文件系统，但它同时还提供了许多以此为基础的
4
Scott Chacon Pro Git 1.3节 Git 基础
超强工具，而不只是一个简单的 VCS。稍后在第三章讨论 Git 分支管理的时候，我们会再
看看这样的设计究竟会带来哪些好处

###1.3.2 近乎所有操作都是本地执行
在 Git 中的绝大多数操作都只需要访问本地文件和资源，不用连网。(git log 一下, 自项目创建以来, 所有的 log 都会列出来, 而不需要依靠网络, 然后 reset 过去)但如果用 CVCS 的
话，差不多所有操作都需要连接网络。因为 Git 在本地磁盘上就保存着所有当前项目的历史
更新，所以处理起来速度飞快。
举个例子，如果要浏览项目的历史更新摘要，Git 不用跑到外面的服务器上去取数据回
来，而直接从本地数据库读取后展示给你看。所以任何时候你都可以马上翻阅，无需等待。
如果想要看当前版本的文件和一个月前的版本之间有何差异，Git 会取出一个月前的快照和
当前文件作一次差异运算，而不用请求远程服务器来做这件事，或是把老版本的文件拉到本
地来作比较

1.3.3 时刻保持数据完整性
在保存到 Git 之前，所有数据都要进行内容的校验和（checksum）计算，并将此结果作
为数据的唯一标识和索引。换句话说，不可能在你修改了文件或目录之后，Git 一无所知。
这项特性作为 Git 的设计哲学，建在整体架构的最底层。所以如果文件在传输时变得不完
整，或者磁盘损坏导致文件数据缺失，Git 都能立即察觉。
Git 使用 SHA-1 算法计算数据的校验和，通过对文件的内容或目录的结构计算出一个
SHA-1 哈希值，作为指纹字符串。该字串由 40 个十六进制字符（0-9 及 a-f）组成，看起
来就像是：
24b9da6552252987aa493b52f8696cd6d3b00373
Git 的工作完全依赖于这类指纹字串，所以你会经常看到这样的哈希值。实际上，所有保
存在 Git 数据库中的东西都是用此哈希值来作索引的，而不是靠文件名。
